[core]
name:银行
class:CustomUnitMetadata
price:2000
isUnrepairableUnit:false
canOnlyBeAttackedByUnitsWithTags:nmsl
canNotBeDirectlyAttacked:false
ignoreInUnitCapCalculation:true
disableDeathOnZeroHp:true
canNotBeDamaged:true
maxHp:100000
selfRegenRate:999999
disableAllUnitCollisions:true
tags:银行
mass:9000
footprint:-1,-1,1,1
constructionFootprint:-1,-1,1,1
displayDescription:你可以在这里进行存款,取款,贷款,股票等操作\n存款的利息为0.001\n贷款的利息为0.002\n贷款额度大于5万则为利滚利\n十分钟内部还款将清除账户余额\n包括存入的资金\n股票每一分钟变化一次\n有10%的几率触发连续波动\n有0.5%的几率触发金融危机\n如果单次股票下跌率超过20%,则触发熔断机制\n15%的代码来自tobby
techLevel:1
buildSpeed:20s
radius:25
isBio:false
isBuilding:true
fogOfWarSightRange:10
autoTriggerCooldownTime:15
defineUnitMemory:float 移动速度,float 攻击距离,float 伤害乘数,float 护盾,float 视野,float 装甲,float 生命,float 间隔


updateUnitMemory:szi=str(int(self.resource.sxjg)),szig=substring(memory.szi,memory.sziw-1,memory.sziw),szis=substring(memory.szi,memory.sziw-2,memory.sziw-1),szib=substring(memory.szi,memory.sziw-3,memory.sziw-2),sziw=length(memory.szi)


@global gs1:王某人责任有限公司
#公司名称
@memory gs1_n:number
#总股数
@global gs1_p:400
#单价
@global gs1_pm:100
#最低单价
@global gs1_pa:10000
#最高单价
@global gs1_mp:0.45
#最大涨幅
@global gs1_me:0.35
#最大跌幅
@memory gp1:number
#当前单价
@memory gp2:number
#上次单价
@memory gb1:number
#当前波动
@memory gb2:number
#上次波动
@memory jd1:number
#巨大几率
@memory wj1:number
#金融危机

#----
@memory bb:number
#巨大波动
@memory jp1:number
#波动临时单价

@memory szi:string
@memory szig:string
@memory szis:string
@memory szib:string
@memory sziw:float

#----
@memory 待增加:number
@memory 待减少:number

[hiddenAction_初始股票]
autoTriggerOnEvent:created
setUnitMemory:gs1_n=40000

[resource_sxjg2]
hidden:true
displayRoundedDown:true
displayName:刷新倒计时

[hiddenAction_计时55222]
autoTrigger:if self.resource.sxjg2 > 0
addResources:sxjg2:-0.25

[hiddenAction_计时开22始]
autoTriggerOnEvent:created
setResourcesWithLogic:sxjg2=60

[resource_1]
hidden:true

[hiddenAction_结束22]
autoTrigger:if self.teamDefeatedTech() and not self.globalTeamTags(includes='fail')
# and self.resource.1 != 1
deleteSelf:true

[hiddenAction_消毁]
autoTriggerOnEvent:destroyed
convertTo:银行

#显示类型

[action_存钱开启]
text:存取项目
price:0
#ai_isHighPriority:true
pos:2.1
displayType:action
alwaysSinglePress:true
addResources:setFlag:30,unsetFlag:29,unsetFlag:28,unsetFlag:27,unsetFlag:24,unsetFlag:25
buildSpeed:0s
isVisible:if not self.hasFlag(id=30)

[action_存钱关闭]
text:关闭存取项目
price:0
pos:2.1
displayType:action
alwaysSinglePress:true
addResources:unsetFlag:30
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_借钱开启]
text:借还项目
price:0
#ai_isHighPriority:true
pos:2.1
displayType:action
alwaysSinglePress:true
addResources:setFlag:29,unsetFlag:30,unsetFlag:28,unsetFlag:27,unsetFlag:24,unsetFlag:25
buildSpeed:0s
isVisible:if not self.hasFlag(id=29)

[action_借钱关闭]
text:关闭借还项目
price:0
pos:2.1
displayType:action
alwaysSinglePress:true
addResources:unsetFlag:29
buildSpeed:0s
isVisible:if self.hasFlag(id=29)

#
[action_存入经济资源显示]
text:存入的资金\n%{self.resource(type="zjj")}
description:你目前存入的钱
price:0
pos:3
displayType:infoOnlyNoBox
isActive:false
buildSpeed:0s
isVisible:true

[action_利息显示]
text:所得的利息\n%{self.resource(type="lix")}
description:--所得利息--\n%{self.resource(type="lix")}\n--共计资金--\n%{self.resource(type="lix")+self.resource(type="zjj")}
price:0
pos:3
displayType:infoOnlyNoBox
isActive:false
buildSpeed:0s
isVisible:true
#isVisible:if self.hasFlag(id=31)

[action_贷款显示]
text:贷款的钱\n%{self.resource(type="dk")}
description:你目前在银行借的钱
price:0
pos:3
displayType:infoOnlyNoBox
isActive:false
buildSpeed:0s
isVisible:true


[action_还贷款显示]
text:需要还的钱\n%{self.resource(type="hdq")}
description:你要给银行所还的钱
price:0
pos:3
displayType:infoOnlyNoBox
isActive:false
buildSpeed:0s
isVisible:true

[action_debug1]
text:公司:${gs1}\n总股数:%{memory.gs1_n}\n单价范围${gs1_pm}-${gs1_pa}\n当前单价%{memory.gp1}\n当前波动:%{memory.gb1}\n随机数测试:%{rnd((-1*${gs1_me}),${gs1_mp})}
isVisible:false
isLocked:false
buildSpeed:0
displayType:infoOnly
pos:3

#存钱

[action_存10]
text:存10
description:在银行中存入10,手续费为1
price:11
addResources:zjj=10
pos:4
ai_isHighPriority:true
isLocked:if self.resource(type="credits") < 11 and self.resource(type="zjj") <= 200000
isLockedMessage:你的资金不够,无法存入
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_存100]
text:存100
description:在银行中存入100,手续费为10
price:110
addResources:zjj=100
pos:4
ai_isHighPriority:true
isLocked:if self.resource(type="credits") < 110 and self.resource(type="zjj") <= 200000
isLockedMessage:你的资金不够,无法存入
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_存1000]
text:存1000
description:在银行中存入1000,手续费为100
price:1100
addResources:zjj=1000
pos:4
ai_isHighPriority:true
isLocked:if self.resource(type="credits") < 1100 and self.resource(type="zjj") <= 200000
isLockedMessage:你的资金不够,无法存入
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_存10000]
text:存10000
description:在银行中存入10000,手续费为1000
price:11000
addResources:zjj=10000,energy=10
pos:4
ai_isHighPriority:true
isLocked:if self.resource(type="credits") < 11000 and self.resource(type="zjj") <= 200000
isLockedMessage:你的资金不够,无法存入
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_存所有]
text:存所有
description:在银行中存入当前有的所有资金\n手续费为当前资金10%
addResourcesWithLogic:zjj=self.resource.credits*0.9
pos:4
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=30)
alsoTriggerAction:所有取消
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0

[hiddenAction_所有取消]
setResourcesWithLogic:credits:0

#取钱

[action_取10]
text:取10
description:取出10
price:-10
addResources:zjj=-10
pos:4
displayType:action
ai_isHighPriority:true
isLocked:if self.resource(type="zjj") < 10
isLockedMessage:存入资金不够，无法取出
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_取100]
text:取100
description:取出100
price:-100
addResources:zjj=-100
pos:4
displayType:action
ai_isHighPriority:true
isLocked:if self.resource(type="zjj") < 100
isLockedMessage:存入资金不够，无法取出
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_取1000]
text:取1000
description:取出1000
price:-1000
addResources:zjj=-1000
pos:4
displayType:action
ai_isHighPriority:true
isLocked:if self.resource(type="zjj") < 1000
isLockedMessage:存入资金不够，无法取出
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_取10000]
text:取10000
description:取出10000
price:-10000
addResources:zjj=-10000
pos:4
displayType:action
ai_isHighPriority:true
isLocked:if self.resource(type="zjj") < 10000
isLockedMessage:存入资金不够，无法取出
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)

[action_取所有]
text:取所有
description:取出在银行中存入的所有资金
addResourcesWithLogic:credits=self.resource(type="zjj")
pos:4
ai_isHighPriority:true
displayType:action
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
buildSpeed:0s
isVisible:if self.hasFlag(id=30)
alsoTriggerAction:所有取出

[hiddenAction_所有取出]
setResourcesWithLogic:zjj:0

[action_取利息]
text:取利息
description:取出现有的利息
addResourcesWithLogic:credits=self.resource(type="lix")
pos:4
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
ai_isHighPriority:true
displayType:action
buildSpeed:0s
isVisible:if self.hasFlag(id=30)
alsoTriggerAction:利息取出

[hiddenAction_利息取出]
setResourcesWithLogic:lix:0

[action_取利息和资金]
text:取利与本
description:取出现有利息与本金
addResourcesWithLogic:credits=self.resource(type="lix"),credits=self.resource(type="zjj")
pos:4
isLockedAltMessage:你还有未还的钱,无法操作
isLockedAlt:if self.resource(type="hdq") > 0
ai_isHighPriority:true
displayType:action
buildSpeed:0s
isVisible:if self.hasFlag(id=30)
alsoTriggerAction:本取出

[hiddenAction_本取出]
setResourcesWithLogic:lix:0,zjj:0

#借钱

[action_借10]
text:借10
description:向银行借10
price:-10
addResources:dk=10
pos:5
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)
isLocked:if not self.customTimer(laterThanSeconds=600)
isLockedMessage:等十分钟以后再借,别想着借钱速推了，好好正常打你的对局¬_¬｀
isLockedAltMessage:请还钱!
isLockedAlt:if self.globalTeamTags(includes="欠钱不还")
isLockedAlt2Message:不能超过100000元
isLockedAlt2:if self.resource(type="dk") >= 100000

[action_借100]
text:借100
description:向银行借100
price:-100
addResources:dk=100
pos:5
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)
isLockedAltMessage:请还钱!
isLockedAlt:if self.globalTeamTags(includes="欠钱不还")
isLocked:if not self.customTimer(laterThanSeconds=600)
isLockedMessage:等十分钟以后再借,别想着借钱速推了，好好正常打你的对局¬_¬｀
isLockedAlt2Message:不能超过100000元
isLockedAlt2:if self.resource(type="dk") >= 100000

[action_借1000]
text:借1000
description:向银行借1000
price:-1000
addResources:dk=1000
pos:5
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)
isLocked:if not self.customTimer(laterThanSeconds=600)
isLockedMessage:等十分钟以后再借,别想着借钱速推了，好好正常打你的对局¬_¬｀
isLockedAltMessage:请还钱!
isLockedAlt:if self.globalTeamTags(includes="欠钱不还")
isLockedAlt2Message:不能超过100000元
isLockedAlt2:if self.resource(type="dk") >= 100000

[action_借10000]
text:借10000
description:向银行借10000
price:-10000
addResources:dk=10000
pos:5
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)
isLockedAltMessage:请还钱!
isLocked:if not self.customTimer(laterThanSeconds=600)
isLockedMessage:等十分钟以后再借,别想着借钱速推了，好好正常打你的对局¬_¬｀
isLockedAlt:if self.globalTeamTags(includes="欠钱不还")
isLockedAlt2Message:不能超过100000元
isLockedAlt2:if self.resource(type="dk") >= 100000

#还钱

[action_还10]
text:还10
description:向银行还10
price:10
addResources:hdq:-10,dk=-10
pos:5
ai_isHighPriority:true
buildSpeed:0s
isLocked:if self.resource(type="hdq") <= 0
isLockedMessage:你还没有贷款!
isVisible:if self.hasFlag(id=29)

[action_还100]
text:还100
description:向银行还100
price:100
addResources:hdq:-100,dk=-100
pos:5
ai_isHighPriority:true
isLockedAltMessage:你不用还这么多的
isLockedAlt:if self.resource(type="hdq") < 100
buildSpeed:0s
isLocked:if self.resource(type="hdq") <= 0
isLockedMessage:你还没有贷款!
isVisible:if self.hasFlag(id=29)

[action_还1000]
text:还1000
description:向银行还1000
price:1000
addResources:hdq=-1000,dk=-1000
pos:5
isLockedAltMessage:你不用还这么多的
isLockedAlt:if self.resource(type="hdq") < 1000
isLocked:if self.resource(type="hdq") <= 0
isLockedMessage:你还没有贷款!
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)

[action_还10000]
text:还10000
description:向银行还10000
isLocked:if self.resource(type="hdq") <= 0
isLockedMessage:你还没有贷款!
price:10000
isLockedAltMessage:你不用还这么多的
isLockedAlt:if self.resource(type="hdq") < 10000
addResources:hdq:-10000,dk=-10000
pos:5
ai_isHighPriority:true
buildSpeed:0s
isVisible:if self.hasFlag(id=29)


#存款利息

[hiddenAction_利息]
autoTrigger:if self.resource(type="zjj") > 0
addResourcesWithLogic:lix:self.resource.zjj*0.00025

#贷款利息

[hiddenAction_贷款利息]
autoTrigger:if self.resource(type="dk") > 0 and self.resource(type="dk") < 50000
addResourcesWithLogic:hdk:self.resource.dk*0.0005

[hiddenAction_贷款利息2]
autoTrigger:if self.resource(type="dk") >= 50000
addResourcesWithLogic:hdk:self.resource.dk*0.0005+self.resource.hdq*0.0005

#下线

[hiddenAction_还贷款下线]
autoTrigger:if self.resource(type="hdk") <= 0
setResourcesWithLogic:hdk:0

[hiddenAction_贷款下线]
autoTrigger:if self.resource(type="dk") <= 0
setResourcesWithLogic:dk:0

[hiddenAction_还钱设置]
autoTrigger:if self.resource(type="dk") > 0 and self.resource(type="hdk") > 0
setResourcesWithLogic:hdq=self.resource.dk+self.resource.hdk

[hiddenAction_还钱下线]
autoTrigger:if self.resource(type="hdq") <= 0
setResourcesWithLogic:hdq=0

[hiddenAction_贷款]
autoTrigger:if self.resource(type="dk") <= 0
setResourcesWithLogic:hdk=0

#催款

[hiddenAction_初始计时]
autoTrigger:if self.resource(type="hdq") <= 0
setResourcesWithLogic:sdjsq:0

[hiddenAction_初始计时2]
autoTrigger:if self.resource(type="sdjsq") <= 600 and self.resource(type="hdq") > 0
addResources:sdjsq:0.25

[hiddenAction_催还钱]
autoTrigger:if self.resource(type="hdq") > 0 and self.resource.sdjsq > 300 and not self.hasFlag(id=26)
showMessageToPlayer:------请尽快还款------
addResources:setFlag:26

[hiddenAction_催2]
autoTrigger:if self.resource(type="hdq") > 0 and self.resource.sdjsq > 540 and not self.hasFlag(id=27)
showMessageToPlayer:------最后一分钟限度------
addResources:setFlag:27

[hiddenAction_催3]
autoTrigger:if self.resource(type="hdq") > 0 and self.resource.sdjsq > 600
showMessageToPlayer:--已经扣除你账户上面的所有资金,您已经被拉入黑名单--
addGlobalTeamTags:欠钱不还
addResources:unsetFlag:26,unsetFlag:27
setResourcesWithLogic:credits:0,zjj:0,lix:0,sdjsq:0

[hiddenAction_还钱]
autoTrigger:if self.resource(type="hdq") <= 0 and self.globalTeamTags(includes="欠钱不还")
showMessageToPlayer:--您已经还完了所有钱,已经从黑名单中移除--
removeGlobalTeamTags:欠钱不还
resetCustomTimer:true
addResources:unsetFlag:27,unsetFlag:26
setResourcesWithLogic:zjj:0,lix:0

[graphics]
total_frames:1
image:银行.png
image_wreak:银行_dead.png
imageScale:1
image_shadow:NONE
shadowOffsetX:1
shadowOffsetY:1

[attack]
canAttack:false
canAttackFlyingUnits:false
canAttackLandUnits:false
canAttackUnderwaterUnits:false
maxAttackRange:0

[movement]
movementType:NONE
moveSpeed:0
moveAccelerationSpeed:0.01
moveDecelerationSpeed:0.01
maxTurnSpeed:0
turnAcceleration:0.1

[ai]
maxEachBase:1
noneInBaseExtraPriority:20
buildPriority:0.05

[hiddenAction_refund]
requireConditional:if numberOfUnitsInTeam(withTag='银行',greaterThan=1,incompleteBuildings=true)
autoTriggerOnEvent:created
addResources:3500
deleteSelf:true
showMessageToPlayer:银行已达建造数量上限，钱已返还

[hiddenAction_开始播报]
autoTriggerOnEvent:created
showMessageToPlayer:AI:%{self.teamName}队的%{self.playerName},感谢使用王某人银行!

#---股票---

#---信息---

[action_显示1]
text:${gs1}\n总股数:%{memory.gs1_n}\n持有数:%{self.resource.gpsl},%{(self.resource.gpsl/40000)*100}%\n单价范围${gs1_pm}-${gs1_pa}
isVisible:true
isLocked:false
buildSpeed:0
displayType:infoOnlyNoBox
pos:3

[action_显示2]
text:当前单价:%{memory.gp1}\n当前价值:%{memory.gp1*self.resource.gpsl}\n当前波动:%{memory.gb1*100}%\n上次波动:%{memory.gb2*100}%
isVisible:true
isLocked:false
buildSpeed:0
displayType:infoOnlyNoBox
pos:3

#---选项---

[action_打开买入]
displayType:action
text:打开买入选项
isVisible:if not self.hasFlag(id=25)
addResources:setFlag=25,unsetFlag:24,unsetFlag:28,unsetFlag:29,unsetFlag:30
allowMultipleInQueue:false
canPlayerCancel:false
alwaysSinglePress:true
pos:2.1
buildSpeed:0

[action_关闭买入]
displayType:action
text:关闭买入选项
isVisible:if self.hasFlag(id=25)
addResources:unsetFlag=25
allowMultipleInQueue:false
canPlayerCancel:false
alwaysSinglePress:true
pos:2.1
buildSpeed:0

[action_打开卖出]
displayType:action
text:打开卖出选项
isVisible:if not self.hasFlag(id=24)
addResources:setFlag=24,unsetFlag:25,unsetFlag:28,unsetFlag:29,unsetFlag:30
allowMultipleInQueue:false
canPlayerCancel:false
alwaysSinglePress:true
pos:2.1
buildSpeed:0

[action_关闭卖出]
displayType:action
text:关闭卖出选项
isVisible:if self.hasFlag(id=24)
addResources:unsetFlag=24
allowMultipleInQueue:false
canPlayerCancel:false
pos:2.1
alwaysSinglePress:true
buildSpeed:0

[action_买入1]
pos:5
@define num:1
setUnitMemory:待减少=${num}*self.resource.gp1c,gs1_n=memory.gs1_n-1
@copyFromSection:action_买入100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:-1

[action_买入10]
pos:5
@define num:10
setUnitMemory:待减少=${num}*self.resource.gp1c,gs1_n=memory.gs1_n-10
@copyFromSection:action_买入100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:-10

[action_买入100]
@define num:100
displayType:action
text:买入${num}股
description:价格${num}*%{memory.gp1}=%{${num}*memory.gp1}
#增加资源:credits=-1*${num}*%{self.resource.gp1c}
isLocked:if self.resource.credits < ${num}*self.resource.gp1c
isLockedMessage:资金不足
isLockedAlt:if ${num} > memory.gs1_n
isLockedAltMessage:超过最大发售数量
isVisible:if self.hasFlag(id=25)
allowMultipleInQueue:false
canPlayerCancel:true
alwaysSinglePress:false
setUnitMemory:待减少=${num}*self.resource.gp1c,gs1_n=memory.gs1_n-100
isLockedAlt2:if self.resource(type="sxjg2") > 0
isLockedAlt2Message:请耐心等待银行开业哦*^_^*\n距离银行开业还剩下%{int(self.resource.sxjg2)}s
pos:5
buildSpeed:1s
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:-100
setResourcesWithLogic:gpsl=self.resource.gpsl+${num}

[action_买入1000]
pos:5
@define num:1000
setUnitMemory:待减少=${num}*self.resource.gp1c,gs1_n=memory.gs1_n-1000
@copyFromSection:action_买入100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:-1000

[action_买入10000]
pos:5
@define num:10000
setUnitMemory:待减少=${num}*self.resource.gp1c,gs1_n=memory.gs1_n-10000
@copyFromSection:action_买入100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:-10000


[action_卖出1]
pos:5
@define num:1
setUnitMemory:待增加=${num}*self.resource.gp1c,gs1_n=memory.gs1_n+1
@copyFromSection:action_卖出100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:+1

[action_卖出10]
pos:5
@define num:10
setUnitMemory:待增加=${num}*self.resource.gp1c,gs1_n=memory.gs1_n+10
@copyFromSection:action_卖出100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:+10

[action_卖出100]
@define num:100
displayType:action
text:卖出${num}股
description:价格${num}*%{memory.gp1}=%{${num}*memory.gp1}
#增加资源:credits=${num}*%{self.resource.gp1c}
isVisible:if self.hasFlag(id=24)
allowMultipleInQueue:false
canPlayerCancel:true
alwaysSinglePress:false
setUnitMemory:待增加=${num}*self.resource.gp1c,gs1_n=memory.gs1_n+100
isLocked:if self.resource.gpsl < ${num}
isLockedMessage:持有的股票数量不足
pos:5
setResourcesWithLogic:gpsl=self.resource.gpsl-${num}
buildSpeed:1s
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:+100

[action_卖出1000]
pos:5
@define num:1000
setUnitMemory:待增加=${num}*self.resource.gp1c,gs1_n=memory.gs1_n+1000
@copyFromSection:action_卖出100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:+1000

[action_卖出10000]
pos:5
@define num:10000
setUnitMemory:待增加=${num}*self.resource.gp1c,gs1_n=memory.gs1_n+10000
@copyFromSection:action_卖出100
sendMessageTo:self.activeWaypointTarget
sendMessageWithTags:+10000


#--资金加减--

[hiddenAction_增加00]
autoTrigger:if memory.待增加 > 0
addResourcesWithLogic:credits=memory.待增加
buildSpeed:0
alsoTriggerAction:待增加

[hiddenAction_待增加]
setUnitMemory:待增加=0

[hiddenAction_减少00]
autoTrigger:if memory.待减少 > 0
addResourcesWithLogic:credits=memory.待减少*-1
buildSpeed:0
alsoTriggerAction:待减少

[hiddenAction_待减少]
setUnitMemory:待减少=0

#---核心部分---

#--资源--

[resource_gp1c]
hidden:true

[resource_wjjs]
hidden:false
displayName:金融危机时间

[resource_rdsj]
hidden:false
displayName:熔断时间

[resource_ssbd]
hidden:false
displayName:上升波动

[resource_xjbd]
hidden:false
displayName:下降波动

[resource_sxjg]
hidden:false
displayRoundedDown:true
displayName:刷新倒计时


[hiddenAction_熔断获取]
autoTrigger:if activeWaypointTarget.resource.rdsj != self.resource.rdsj
setResourcesWithLogic:rdsj=activeWaypointTarget.resource.rdsj

[hiddenAction_刷新获取]
autoTrigger:if activeWaypointTarget.resource.sxjg != self.resource.sxjg
setResourcesWithLogic:sxjg=activeWaypointTarget.resource.sxjg

[hiddenAction_危机获取]
autoTrigger:if activeWaypointTarget.resource.wjjs != self.resource.wjjs
setResourcesWithLogic:rdsj=activeWaypointTarget.resource.wjjs

[hiddenAction_单价获取]
autoTrigger:if activeWaypointTarget.resource.gp1c != self.resource.gp1c
setResourcesWithLogic:gp1c=activeWaypointTarget.resource.gp1c

[hiddenAction_票价获取]
autoTrigger:if activeWaypointTarget.readUnitMemory('gp1',type='number') != memory.gp1
setUnitMemory:gp1=activeWaypointTarget.readUnitMemory('gp1',type='number')

[hiddenAction_票价获取2]
autoTrigger:if activeWaypointTarget.readUnitMemory('gp2',type='number') != memory.gp2
setUnitMemory:gp2=activeWaypointTarget.readUnitMemory('gp2',type='number')

[hiddenAction_上次票价获取]
autoTrigger:if activeWaypointTarget.readUnitMemory('gb2',type='number') != memory.gb2
setUnitMemory:gb2=activeWaypointTarget.readUnitMemory('gb2',type='number')

[hiddenAction_上次票价获取2]
autoTrigger:if activeWaypointTarget.readUnitMemory('gb1',type='number') != memory.gb1
setUnitMemory:gb1=activeWaypointTarget.readUnitMemory('gb1',type='number')

[hiddenAction_总数取2]
autoTrigger:if activeWaypointTarget.readUnitMemory('gs1_n',type='number') != memory.gs1_n
setUnitMemory:gs1_n=activeWaypointTarget.readUnitMemory('gs1_n',type='number')

#--decal显示--
[decal_波动显示]
@define gb1_d:memory.gb1
alwaysStartDirAtZero:true
onlyPlayersWithUnitControl:true
order:0
hOffset:30
isVisible:if memory.gb1 >= 0
xOffsetAbsolute:0
imageScale:1
imageScaleX:${gb1_d}
image:buff条.png
yOffsetAbsolute:2

[decal_波动显示2]
@define gb1_d:memory.gb1
alwaysStartDirAtZero:true
onlyPlayersWithUnitControl:true
order:0
hOffset:30
xOffsetAbsolute:0
imageScale:1
imageScaleX:${gb1_d}
isVisible:if memory.gb1 < 0
image:绿buff条.png
yOffsetAbsolute:2

[decal_波动框]
alwaysStartDirAtZero:true
onlyPlayersWithUnitControl:true
order:0
hOffset:30
xOffsetAbsolute:0
image:条框.png
imageScale:1
imageScaleX:1
imageScaleY:1
yOffsetAbsolute:2
#@copyFromSection:decal_波动显示

[decal_波动图标-上涨]
alwaysStartDirAtZero:true
onlyPlayersWithUnitControl:true
order:0
hOffset:30
image:上涨.png
imageScaleX:1
imageScaleY:1
imageScale:0.3
isVisible:if memory.gb1 >= 0
yOffsetAbsolute:-15
#@copyFromSection:decal_波动框

[decal_波动图标-下跌]
alwaysStartDirAtZero:true
onlyPlayersWithUnitControl:true
order:0
hOffset:30
image:下跌.png
imageScaleX:1
imageScaleY:1
imageScale:0.3
isVisible:if memory.gb1 < 0
yOffsetAbsolute:-15
#@copyFromSection:decal_波动框



#---倒计时显示

[decal_熔断示1]
image:熔断.png
imageScaleX:1
imageScaleY:1
imageScale:0.22
yOffsetAbsolute:30
xOffsetAbsolute:-30
isVisible:if self.resource.rdsj > 0
@copyFromSection:decal_波动框

[decal_倒计时显示1]
image:刷新.png
imageScaleX:1
imageScaleY:1
imageScale:0.22
yOffsetAbsolute:-14
xOffsetAbsolute:-30
@copyFromSection:decal_波动框

[template_szi]
layer:onTop
order:10.01
image:0.png
imageScale:0.3
isVisible:if memory.szig ==  '0'
#alwayStartDirAtZero:trueonlWhileAlive:trueonlyOnNonPreview:trueonlyWhenSelectedByAnyPlayer:true
yOffsetAbsolute:-45
xOffsetAbsolute:34

[template_szii]
layer:onTop
order:10.01
image:0.png
imageScale:0.3
isVisible:if memory.szis ==  '0'
alwayStartDirAtZero:true
#onlyWhileAlive:trueonlyOnNonPreview:trueonlyWhenSelectedByAnyPlayer:true
yOffsetAbsolute:-45
xOffsetAbsolute:25

[template_szik]
layer:onTop
order:10.01
image:0.png
imageScale:0.3
isVisible:if memory.szib ==  '0'
#alwayStartDirAtZero:trueonlyWhileAlive:trueonlyOnNonPreview:trueonlyWhenSelectedByAnyPlayer:true
yOffsetAbsolute:-45
xOffsetAbsolute:18

#----数字----

[decal_szi_g_0]
@copyFromSection:template_szi

[decal_szi_g_1]
@copyFromSection:template_szi
image:1.png
isVisible:if memory.szig ==  '1'

[decal_szi_g_2]
@copyFromSection:template_szi
image:2.png
isVisible:if memory.szig ==  '2'

[decal_szi_g_3]
@copyFromSection:template_szi
image:3.png
isVisible:if memory.szig ==  '3'

[decal_szi_g_4]
@copyFromSection:template_szi
image:4.png
isVisible:if memory.szig ==  '4'

[decal_szi_g_5]
@copyFromSection:template_szi
image:5.png
isVisible:if memory.szig ==  '5'

[decal_szi_g_6]
@copyFromSection:template_szi
image:6.png
isVisible:if memory.szig ==  '6'

[decal_szi_g_7]
@copyFromSection:template_szi
image:7.png
isVisible:if memory.szig ==  '7'

[decal_szi_g_8]
@copyFromSection:template_szi
image:8.png
isVisible:if memory.szig ==  '8'

[decal_szi_g_9]
@copyFromSection:template_szi
image:9.png
isVisible:if memory.szig ==  '9'


[decal_szi_s_0]
@copyFromSection:template_szii

[decal_szi_s_1]
@copyFromSection:template_szii
image:1.png
isVisible:if memory.szis ==  '1'

[decal_szi_s_2]
@copyFromSection:template_szii
image:2.png
isVisible:if memory.szis ==  '2'

[decal_szi_s_3]
@copyFromSection:template_szii
image:3.png
isVisible:if memory.szis ==  '3'

[decal_szi_s_4]
@copyFromSection:template_szii
image:4.png
isVisible:if memory.szis ==  '4'

[decal_szi_s_5]
@copyFromSection:template_szii
image:5.png
isVisible:if memory.szis ==  '5'

[decal_szi_s_6]
@copyFromSection:template_szii
image:6.png
isVisible:if memory.szis ==  '6'

[decal_szi_s_7]
@copyFromSection:template_szii
image:7.png
isVisible:if memory.szis ==  '7'

[decal_szi_s_8]
@copyFromSection:template_szii
image:8.png
isVisible:if memory.szis ==  '8'

[decal_szi_s_9]
@copyFromSection:template_szii
image:9.png
isVisible:if memory.szis ==  '9'



[decal_szi_b_0]
@copyFromSection:template_szik

[decal_szi_b_1]
@copyFromSection:template_szik
image:1.png
isVisible:if memory.szib ==  '1'

[decal_szi_b_2]
@copyFromSection:template_szik
image:2.png
isVisible:if memory.szib ==  '2'

[decal_szi_b_3]
@copyFromSection:template_szik
image:3.png
isVisible:if memory.szib ==  '3'

[decal_szi_b_4]
@copyFromSection:template_szik
image:4.png
isVisible:if memory.szib ==  '4'

[decal_szi_b_5]
@copyFromSection:template_szik
image:5.png
isVisible:if memory.szib ==  '5'

[decal_szi_b_6]
@copyFromSection:template_szik
image:6.png
isVisible:if memory.szib ==  '6'

[decal_szi_b_7]
@copyFromSection:template_szik
image:7.png
isVisible:if memory.szib ==  '7'

[decal_szi_b_8]
@copyFromSection:template_szik
image:8.png
isVisible:if memory.szib ==  '8'

[decal_szi_b_9]
@copyFromSection:template_szik
image:9.png
isVisible:if memory.szib ==  '9'

#------人机炒股-----


[hiddenAction_人机打开股票]
autoTrigger:if not self.hasFlag(id=24) and self.isControlledByAI() or not self.hasFlag(id=25) and self.isControlledByAI()
addResources:setFlag=24,setFlag=25

#----下跌30%卖股----

[hiddenAction_人机卖股]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 0 and self.resource.gpsl < 9 and memory.gb1 < -0.3 and self.queueSize() <= 0 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出1

[hiddenAction_人机卖股2]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 10 and self.resource.gpsl < 99 and memory.gb1 < -0.3 and self.queueSize() <= 0 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出10

[hiddenAction_人机卖股3]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 99 and memory.gb1 < -0.3 and self.queueSize() <= 0 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出100

#----连续下跌卖股----

[hiddenAction_人机卖股连续]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 0 and self.resource.gpsl < 9 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.resource.xjbd <= 3 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出1

[hiddenAction_人机卖股连续2]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 10 and self.resource.gpsl < 99 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出10

[hiddenAction_人机卖股连续3]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 99 and self.resource.xjbd > 2 and self.resource.xjbd <= 3 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出100


#----上涨20%以上卖----

[hiddenAction_人机卖股-20]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 0 and self.resource.gpsl < 10 and memory.gb1 > 0.2 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出1

[hiddenAction_人机卖股2-20]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 10 and self.resource.gpsl < 100 and memory.gb1 > 0.2 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出10

[hiddenAction_人机卖股3-20]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 100 and memory.gb1 > 0.2 and self.queueSize() <= 0 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出100

#----连续上张3次卖出----

[hiddenAction_人机连续上2]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 0 and self.resource.gpsl < 10 and self.resource.ssbd > 1 and self.resource.ssbd <= 3 and memory.gb1 > 0.2 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出1

[hiddenAction_人机连续上2-2]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 10 and self.resource.gpsl < 99 and self.resource.ssbd > 1 and self.resource.ssbd <= 3 and memory.gb1 > 0.2 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出10

[hiddenAction_人机连续上2-3]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 99 and self.resource.ssbd > 1 and self.resource.ssbd <= 3 and memory.gb1 > 0.2 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出100

#-----连续上涨4次卖----

[hiddenAction_人机连续上4]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 0 and self.resource.gpsl < 10 and self.resource.ssbd == 4 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出1

[hiddenAction_人机连续上4-2]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 10 and self.resource.gpsl < 99 and self.resource.ssbd == 4 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出10

[hiddenAction_人机连续上4-3]
autoTrigger:if self.isControlledByAI() and self.resource.gpsl > 99 and self.resource.ssbd == 4 and self.resource(type="wjjs") <= 0
alsoQueueAction:卖出100

#----下跌4次买----

[hiddenAction_人机连续买股]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*1.5*1 and self.queueSize() <= 0 and self.resource.gpsl < 9 and self.resource.xjbd > 3 and memory.gs1_n > 0
alsoQueueAction:买入1

[hiddenAction_人机连续买股2]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*1.5*10 and self.queueSize() <= 0 and self.resource.gpsl < 99 and self.resource.xjbd > 3 and memory.gs1_n > 0
alsoQueueAction:买入10

[hiddenAction_人机连续买股3]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*1.5*1 and self.queueSize() <= 0 and self.resource.gpsl < 999 and self.resource.xjbd > 3 and memory.gs1_n > 0
alsoQueueAction:买入100

#----人机正常买股----

[hiddenAction_人机买股1]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*2*1 and self.queueSize() <= 0 and memory.gb1 <= 0 and memory.gb2 > 0 and self.resource.gpsl <= 10 and memory.gp1 <= 800 and self.resource.xjbd < 4 and memory.gs1_n > 0
alsoQueueAction:买入1

[hiddenAction_人机买股10]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*2*10 and self.queueSize() <= 0 and memory.gb1 <= 0 and memory.gb2 > 0 and self.resource.gpsl <= 100 and memory.gp1 <= 800 and self.resource.xjbd < 4 and memory.gs1_n > 0
alsoQueueAction:买入10

[hiddenAction_人机买股100]
autoTrigger:if self.isControlledByAI() and self.resource.credits > self.resource.gp1c*2*100 and self.queueSize() <= 0 and memory.gb1 <= 0 and memory.gb2 > 0 and self.resource.gpsl <= 1000 and memory.gp1 <= 800 and self.resource.xjbd < 4 and memory.gs1_n > 0
alsoQueueAction:买入100

[hiddenAction_人机股票数量]
autoTrigger:if self.resource.gpsl < 0
addResourcesWithLogic:gpsl=0

[hiddenAction_查找中]
autoTrigger:if not activeWaypointTarget.tags(includes='银行接收器')
addWaypoint_target_nearestUnit_team:any
addWaypoint_target_nearestUnit_tagged:银行接收器
addWaypoint_type:guard
clearActiveWaypoint:true
addWaypoint_target_nearestUnit_maxRange:99999

